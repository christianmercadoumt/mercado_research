---
title: "lolo"
author: "Christian M"
date: "October 2, 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
```

**Reading in the data**

1. Make sure tidyverse is loaded (to use the pipe function %>%)
2. List files in directory (within data folder)
3. Combine each file into one data frame (or tibble)

```{r}
lolo_data <- fs::dir_ls("data/lolo")
lolo_all_raw <- lolo_data %>% map_dfr(read_csv)
```

**Decluttering**



```{r}
#omitting data that isn't immediately useful

lolo_omit <- select(lolo_all_raw, SETTING_ID, MEASUREMENT_DATE, MEASUREMENT_NO, PURPOSE_CODE, PLOT, SUBPLOT, LIVE_DEAD, SPECIES_SYMBOL, DIAMETER, TPA_EQUIV, BASAL_AREA_EQUIV, HEIGHT, CROWN_RATIO, CROWN_CLASS, AGE, RADIAL_GROWTH, HEIGHT_GROWTH)

#cleaning up dates, adding column with proper date format.

lolo1 <- mutate(lolo_omit, mdate = as.Date(MEASUREMENT_DATE, format = "%m/%d/%Y"))

#adding column with measure year

lolo1a <- mutate(lolo1, myear = format(mdate, format = "%Y"))

unique(lolo_omit$SETTING_ID)
length(unique(lolo_omit$SETTING_ID))
```

1. Omitting data (SET_CN, PLOT_CN, TREE_CN, TAG_ID, AZIMUTH, DISTANCE, SNAD_DECA and disturbance items.

2. There are `r length(unique(lolo_omit$SETTING_ID))` stands in the lolo dataset.

3. There are `r length(unique(lolo_omit$MEASUREMENT_DATE))` different measurement dates.
a. clean up dates, extract useful info




```{r}
stand1 <- lolo1a[lolo1a$SETTING_ID == "01160304010002", ]
stand1 <- stand1[stand1$myear == 1987, ]
stand1 <- stand1[round(stand1$PLOT, -2) == 100, ]
```


```{r}
ggplot(stand1, aes(x = DIAMETER, y = HEIGHT, color = SPECIES_SYMBOL)) + geom_point() + geom_smooth(se = F)
```

```{r}
hdplot <- function(settingID, year, cluster) {

stand1 <- lolo1a[lolo1a$SETTING_ID == settingID, ]
stand1 <- stand1[stand1$myear == year, ]
stand1 <- stand1[round(stand1$PLOT, -2) == cluster, ]

ggplot(stand1, aes(x = DIAMETER, y = HEIGHT, color = SPECIES_SYMBOL)) + geom_point() + geom_smooth(se = F)}

hdplot("01160304010002", 1987, 200)
```

